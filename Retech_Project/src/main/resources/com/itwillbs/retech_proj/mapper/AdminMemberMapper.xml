<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itwillbs.retech_proj.mapper.AdminMemberMapper">
	<!-- 회원 -->
	<!-- 회원 총 개수 -->
	<select id="selectMemberListCount" resultType="int">
		SELECT COUNT(*)
		FROM member
		<if test="!searchKeyword.equals('')">
			WHERE 
				member_num like concat('%',#{searchKeyword},'%')
				or member_id like concat('%',#{searchKeyword},'%')
				or member_name like concat('%',#{searchKeyword},'%')
				or member_join_date like concat('%',#{searchKeyword},'%')
				or member_status like concat('%',#{searchKeyword},'%')
		</if>
	</select>
	
	<!-- 회원 목록 조회 -->
	<select id="selectMemberList" resultType="member">
		SELECT *
		FROM member
		<if test="!searchKeyword.equals('')">
			where 
				member_id like concat('%',#{searchKeyword},'%')
				or member_name like concat('%',#{searchKeyword},'%')
				or member_status like concat('%',#{searchKeyword},'%')
		</if>
		ORDER BY
			member_isAdmin DESC
		LIMIT
			#{startRow}     
			, #{listLimit}  
	</select>
	
	<!-- 관리자 권한 부여 / 해제 
		 파라미터로 받은 String member_isAdmin 으로 바꿔주기 -->
	
	<update id="updateAdminAuth">
		UPDATE member
		SET 
			<choose>
				<when test="member_isAdmin == 'N'">
					member_isAdmin = 'Y'
				</when>
				<otherwise>
					member_isAdmin = 'N'
				</otherwise>
			</choose>
		WHERE member_id = #{member_id}
	</update>

	

</mapper>